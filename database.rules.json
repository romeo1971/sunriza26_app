{
  "rules": {
    // Helper Functions (Struppi-System)
    ".read": "auth != null",
    ".write": "auth != null",
    
    // User Data (Struppi-System)
    "users": {
      "$uid": {
        ".read": "auth != null && auth.uid == $uid",
        ".write": "auth != null && auth.uid == $uid",
        ".validate": "newData.hasChildren(['uid', 'email', 'createdAt', 'updatedAt'])"
      }
    },
    
    // Avatar Data (Struppi-System)
    "avatars": {
      "$avatarId": {
        ".read": "auth != null && (data.child('userId').val() == auth.uid || data.child('isPublic').val() == true)",
        ".write": "auth != null && data.child('userId').val() == auth.uid",
        ".validate": "newData.hasChildren(['id', 'userId', 'firstName', 'createdAt', 'updatedAt'])"
      }
    },
    
    // Chat Messages (Struppi-System)
    "chats": {
      "$chatId": {
        ".read": "auth != null",
        ".write": "auth != null",
        "messages": {
          "$messageId": {
            ".read": "auth != null",
            ".write": "auth != null && newData.child('userId').val() == auth.uid",
            ".validate": "newData.hasChildren(['userId', 'text', 'timestamp', 'type'])"
          }
        }
      }
    },
    
    // User Settings (Struppi-System)
    "user_settings": {
      "$uid": {
        ".read": "auth != null && auth.uid == $uid",
        ".write": "auth != null && auth.uid == $uid"
      }
    },
    
    // Notifications (Struppi-System)
    "notifications": {
      "$notificationId": {
        ".read": "auth != null && data.child('userId').val() == auth.uid",
        ".write": "auth != null && newData.child('userId').val() == auth.uid",
        ".validate": "newData.hasChildren(['userId', 'title', 'message', 'createdAt'])"
      }
    },
    
    // Analytics (Struppi-System)
    "analytics": {
      "$docId": {
        ".read": "auth != null && data.child('userId').val() == auth.uid",
        ".write": "auth != null && newData.child('userId').val() == auth.uid",
        ".validate": "newData.hasChildren(['userId', 'event', 'timestamp'])"
      }
    },
    
    // Diagnostics (Struppi-System)
    "diagnostics": {
      "$uid": {
        ".read": "auth != null",
        ".write": "auth != null"
      }
    },
    
    // Public Data (Struppi-System)
    "public": {
      ".read": "true",
      ".write": "auth != null"
    }
  }
}
